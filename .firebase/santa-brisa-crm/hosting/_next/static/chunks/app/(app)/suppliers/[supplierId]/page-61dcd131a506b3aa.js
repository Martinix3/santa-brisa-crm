(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7673],{4440:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>z});var a=t(95155),s=t(12115),l=t(35695),o=t(30285),d=t(66695),n=t(85127),i=t(51055),c=t(50172),x=t(31949),m=t(12543),u=t(85081),g=t(18763),b=t(31554),h=t(19637),p=t(83662),f=t(55465),v=t(44861),y=t(83343),j=t(73168),N=t(61055),w=t(96656),A=t(61930),C=t(87481),k=t(6874),E=t.n(k),R=t(34477);let P=(0,R.createServerReference)("7f26ad868b72121bb5cb36ce13e1562d240fad00d8",R.callServer,void 0,R.findSourceMapURL,"getSupplierByIdFS"),S=(0,R.createServerReference)("7f253f478e5389649517128b1eefe835b9d89f07af",R.callServer,void 0,R.findSourceMapURL,"updateSupplierFS"),F=(0,R.createServerReference)("7ff30bc2d0f6e41e3d87d4984ff50fbab9c0207464",R.callServer,void 0,R.findSourceMapURL,"getPurchasesFS"),H=e=>{if(!e)return"No especificada";let r=[e.street,e.number,e.city,e.province,e.postalCode,e.country||"Espa\xf1a"].filter(Boolean);return 0===r.length?"No especificada":r.join(", ")};function z(){let e=(0,l.useParams)(),r=(0,l.useRouter)(),{userRole:t,refreshDataSignature:k}=(0,i.A)(),{toast:R}=(0,C.dj)(),[z,M]=s.useState(null),[B,T]=s.useState([]),[_,I]=s.useState(!0),[L,Z]=s.useState(!1),D=e.supplierId,U="Admin"===t;s.useEffect(()=>{!async function(){if(!D){I(!1),M(null);return}I(!0);try{let[e,r]=await Promise.all([P(D),F(D)]);M(e),e&&T(r)}catch(e){console.error("Error fetching supplier details or related data:",e),R({title:"Error al Cargar Datos",description:"No se pudo cargar la informaci\xf3n del proveedor.",variant:"destructive"}),M(null)}finally{I(!1)}}()},[D,R,k]);let V=async e=>{if(U&&z){I(!0);try{await S(z.id,e),k(),R({title:"\xa1Proveedor Actualizado!",description:'El proveedor "'.concat(e.name,'" ha sido actualizado.')}),Z(!1)}catch(e){console.error("Error updating supplier:",e),R({title:"Error al Actualizar",description:"No se pudo actualizar el proveedor.",variant:"destructive"})}finally{I(!1)}}};return _?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-8",children:[(0,a.jsx)(c.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,a.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Cargando detalles del proveedor..."})]}):z?(z.createdAt&&(0,v.f)((0,y.H)(z.createdAt))&&(0,j.GP)((0,y.H)(z.createdAt),"dd/MM/yyyy",{locale:N.es}),z.updatedAt&&(0,v.f)((0,y.H)(z.updatedAt))&&(0,j.GP)((0,y.H)(z.updatedAt),"dd/MM/yyyy HH:mm",{locale:N.es}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("header",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(o.$,{variant:"outline",size:"icon",onClick:()=>r.push("/suppliers"),"aria-label":"Volver a proveedores",children:(0,a.jsx)(m.A,{className:"h-5 w-5"})}),(0,a.jsx)(u.A,{className:"h-8 w-8 text-primary"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-headline font-semibold",children:z.name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["CIF/NIF: ",z.cif||"No especificado"]})]})]}),U&&(0,a.jsxs)(o.$,{onClick:()=>{U&&z&&Z(!0)},disabled:_,children:[(0,a.jsx)(g.A,{className:"mr-2 h-4 w-4"})," Editar Proveedor"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(d.Zp,{className:"shadow-subtle",children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{className:"text-lg",children:"Informaci\xf3n de Contacto"})}),(0,a.jsxs)(d.Wu,{className:"space-y-2 text-sm",children:[z.contactName&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.A,{size:16,className:"text-muted-foreground"})," ",(0,a.jsx)("span",{children:z.contactName})]}),z.contactEmail&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.A,{size:16,className:"text-muted-foreground"})," ",(0,a.jsx)("a",{href:"mailto:".concat(z.contactEmail),className:"text-primary hover:underline",children:z.contactEmail})]}),z.contactPhone&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.A,{size:16,className:"text-muted-foreground"})," ",(0,a.jsx)("span",{children:z.contactPhone})]}),!z.contactName&&!z.contactEmail&&!z.contactPhone&&(0,a.jsx)("p",{className:"text-muted-foreground",children:"No hay informaci\xf3n de contacto."})]})]}),(0,a.jsxs)(d.Zp,{className:"shadow-subtle",children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{className:"text-lg",children:"Direcci\xf3n"})}),(0,a.jsx)(d.Wu,{className:"space-y-2 text-sm",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(p.A,{size:16,className:"text-muted-foreground mt-1"})," ",(0,a.jsx)("p",{className:"whitespace-pre-line",children:H(z.address)})]})})]})]}),(0,a.jsxs)(d.Zp,{className:"shadow-subtle",children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{className:"text-lg",children:"Notas"})}),(0,a.jsx)(d.Wu,{className:"text-sm",children:(0,a.jsx)("p",{className:"text-muted-foreground whitespace-pre-line",children:z.notes||"No hay notas para este proveedor."})})]}),(0,a.jsxs)(d.Zp,{className:"shadow-subtle",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Historial de Compras"}),(0,a.jsx)(d.BT,{children:"Registro de todas las compras realizadas a este proveedor."})]}),(0,a.jsx)(d.Wu,{children:B.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(n.XI,{children:[(0,a.jsx)(n.A0,{children:(0,a.jsxs)(n.Hj,{children:[(0,a.jsx)(n.nd,{children:"Fecha"}),(0,a.jsx)(n.nd,{children:"Concepto Principal"}),(0,a.jsx)(n.nd,{className:"text-right",children:"Importe Total"}),(0,a.jsx)(n.nd,{className:"text-center",children:"Estado Doc."}),(0,a.jsx)(n.nd,{className:"text-right",children:"Acciones"})]})}),(0,a.jsx)(n.BF,{children:B.map(e=>(0,a.jsxs)(n.Hj,{children:[(0,a.jsx)(n.nA,{children:(0,j.GP)((0,y.H)(e.fechaCreacion),"dd/MM/yyyy")}),(0,a.jsx)(n.nA,{children:e.invoiceNumber||"Gasto General"}),(0,a.jsx)(n.nA,{className:"text-right",children:(0,a.jsx)(A.A,{value:e.monto,options:{style:"currency",currency:"EUR"}})}),(0,a.jsx)(n.nA,{className:"text-center",children:(0,a.jsx)(w.A,{type:"document",status:e.estadoDocumento})}),(0,a.jsx)(n.nA,{className:"text-right",children:(0,a.jsx)(o.$,{asChild:!0,variant:"outline",size:"sm",children:(0,a.jsx)(E(),{href:"/purchases",children:"Ver Compra"})})})]},e.id))})]})}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No hay compras registradas para este proveedor."})})]}),U&&z&&(0,a.jsx)(f.A,{supplier:z,isOpen:L,onOpenChange:Z,onSave:V})]})):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-8",children:[(0,a.jsx)(x.A,{className:"h-16 w-16 text-destructive mb-4"}),(0,a.jsx)("h1",{className:"text-2xl font-semibold mb-2",children:"Proveedor no Encontrado"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"El proveedor que buscas no existe o ha sido eliminado."}),(0,a.jsxs)(o.$,{onClick:()=>r.push("/suppliers"),children:[(0,a.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Volver a Proveedores"]})]})}},26126:(e,r,t)=>{"use strict";t.d(r,{E:()=>d});var a=t(95155);t(12115);var s=t(74466),l=t(59434);let o=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:r,variant:t,...s}=e;return(0,a.jsx)("div",{className:(0,l.cn)(o({variant:t}),r),...s})}},54165:(e,r,t)=>{"use strict";t.d(r,{Cf:()=>m,Es:()=>g,HM:()=>c,L3:()=>b,c7:()=>u,lG:()=>n,rr:()=>h});var a=t(95155),s=t(12115),l=t(15452),o=t(25318),d=t(59434);let n=l.bL;l.l9;let i=l.ZL,c=l.bm,x=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(l.hJ,{ref:r,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s})});x.displayName=l.hJ.displayName;let m=s.forwardRef((e,r)=>{let{className:t,children:s,...n}=e;return(0,a.jsxs)(i,{children:[(0,a.jsx)(x,{}),(0,a.jsxs)(l.UC,{ref:r,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[s,(0,a.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=l.UC.displayName;let u=e=>{let{className:r,...t}=e;return(0,a.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",r),...t})};u.displayName="DialogHeader";let g=e=>{let{className:r,...t}=e;return(0,a.jsx)("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...t})};g.displayName="DialogFooter";let b=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(l.hE,{ref:r,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",t),...s})});b.displayName=l.hE.displayName;let h=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(l.VY,{ref:r,className:(0,d.cn)("text-sm text-muted-foreground",t),...s})});h.displayName=l.VY.displayName},55596:(e,r,t)=>{Promise.resolve().then(t.bind(t,4440))},61930:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var a=t(95155),s=t(12115);let l=e=>{let{value:r,options:t,locale:l="en-US",placeholder:o="N/D"}=e,[d,n]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{n(!0)},[]),"number"!=typeof r||isNaN(r))return(0,a.jsx)(a.Fragment,{children:o});if(!d){let e=2*(r%1!=0);return(0,a.jsx)(a.Fragment,{children:r.toFixed(e)})}return(0,a.jsx)(a.Fragment,{children:r.toLocaleString(l,t)})}},85081:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(40157).A)("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]])},85127:(e,r,t)=>{"use strict";t.d(r,{A0:()=>d,BF:()=>n,Hj:()=>i,XI:()=>o,nA:()=>x,nd:()=>c});var a=t(95155),s=t(12115),l=t(59434);let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:r,className:(0,l.cn)("w-full caption-bottom text-sm",t),...s})})});o.displayName="Table";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("thead",{ref:r,className:(0,l.cn)("[&_tr]:border-b",t),...s})});d.displayName="TableHeader";let n=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tbody",{ref:r,className:(0,l.cn)("[&_tr:last-child]:border-0",t),...s})});n.displayName="TableBody",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tfoot",{ref:r,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s})}).displayName="TableFooter";let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tr",{ref:r,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s})});i.displayName="TableRow";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("th",{ref:r,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s})});c.displayName="TableHead";let x=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("td",{ref:r,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...s})});x.displayName="TableCell",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("caption",{ref:r,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",t),...s})}).displayName="TableCaption"},96656:(e,r,t)=>{"use strict";t.d(r,{A:()=>d});var a=t(95155),s=t(26126),l=t(59434);let o={order:{Entregado:"bg-green-500 hover:bg-green-600 text-white",Completado:"bg-green-100 text-green-800 border border-green-300",Facturado:"bg-teal-500 hover:bg-teal-600 text-white",Confirmado:"bg-[hsl(var(--brand-turquoise-hsl))] hover:brightness-90 text-white",Enviado:"bg-purple-500 hover:bg-purple-600 text-white",Pendiente:"bg-yellow-400 hover:bg-yellow-500 text-black",Procesando:"bg-orange-400 hover:bg-orange-500 text-black",Programada:"bg-sky-500 hover:bg-sky-600 text-white",Cancelado:"bg-red-500 hover:bg-red-600 text-white",Fallido:"bg-red-500 hover:bg-red-600 text-white",Seguimiento:"bg-yellow-400 hover:bg-yellow-500 text-black"},account:{Repetición:"bg-emerald-500 hover:bg-emerald-600 text-white font-semibold",Activo:"bg-emerald-100 text-emerald-800 border border-emerald-200",Inactivo:"bg-orange-100 text-orange-800 border border-orange-200",Programada:"bg-amber-100 text-amber-800 border border-amber-200",Seguimiento:"bg-amber-100 text-amber-800 border border-amber-200",Fallido:"bg-rose-100 text-rose-800 border border-rose-200","Pendiente (Sin Interacci\xf3n)":"bg-gray-100 text-gray-800 border border-gray-200"},event:{Completado:"bg-green-500 hover:bg-green-600 text-white",Confirmado:"bg-blue-500 hover:bg-blue-600 text-white","En Curso":"bg-purple-500 hover:bg-purple-600 text-white",Planificado:"bg-yellow-400 hover:bg-yellow-500 text-black",Pospuesto:"bg-orange-400 hover:bg-orange-500 text-black",Cancelado:"bg-red-500 hover:bg-red-600 text-white"},document:{proforma:"bg-blue-100 text-blue-800 border border-blue-200",factura_pendiente:"bg-yellow-100 text-yellow-800 border border-yellow-200",factura_recibida:"bg-purple-100 text-purple-800 border border-purple-200",factura_validada:"bg-green-100 text-green-800 border border-green-200"},payment:{pagado:"bg-green-500 hover:bg-green-600 text-white",parcial:"bg-orange-400 hover:bg-orange-500 text-black",pendiente:"bg-red-500 hover:bg-red-600 text-white"},production:{Borrador:"bg-gray-400 hover:bg-gray-500 text-white",Programada:"bg-blue-400 hover:bg-blue-500 text-white","En curso":"bg-purple-500 hover:bg-purple-600 text-white",Pausada:"bg-orange-400 hover:bg-orange-500 text-black",Finalizada:"bg-green-500 hover:bg-green-600 text-white",Cancelada:"bg-red-500 hover:bg-red-600 text-white"},qc:{Released:"bg-green-100 text-green-800 border-green-300",Pending:"bg-yellow-100 text-yellow-800 border-yellow-300",Rejected:"bg-red-100 text-red-800 border-red-300"},tank:{Libre:"bg-green-100 text-green-800 border-green-300",Ocupado:"bg-gray-200 text-gray-800 border-gray-300",Limpieza:"bg-yellow-100 text-yellow-800 border-yellow-300"}};function d(e){var r;let{type:t,status:d,className:n}=e,i=(null==(r=o[t])?void 0:r[d])||"bg-gray-400 hover:bg-gray-500 text-white";return"account"===t&&e.isOverdue&&(i="bg-rose-600 hover:bg-rose-700 text-white"),(0,a.jsx)(s.E,{className:(0,l.cn)(i,"text-xs",n),children:d})}}},e=>{var r=r=>e(e.s=r);e.O(0,[2992,7138,5769,8884,1915,1490,587,7328,8965,1859,6874,6060,9105,6315,5465,8441,1684,7358],()=>r(55596)),_N_E=e.O()}]);